<a class="medium-card border border-gray-600 dark:border-white group" [routerLink]="createContentUrl(content.kind, content._id, content.title)" *ngIf="size === 'large'">
    <div class="flex items-center">
        <h3
            class="title"
            [matTooltip]="content.title"
            [matTooltipClass]="'offprint-tooltip'"
            [matTooltipShowDelay]="600"
        >
            {{ content.title }}
        </h3>
        <dragonfish-tag-badge [kind]="tagKind.Rating" [rating]="content.meta.rating" [hasIcon]="false"></dragonfish-tag-badge>
    </div>
    <div class="flex items-center pb-0.5 text-xs border-b border-gray-600 dark:border-white group-hover:border-white">
        <div class="flex-1">
            by {{ $any(content.author).screenName }}
        </div>
        <div class="flex items-center">
            <rmx-icon name="heart-line" class="relative top-1" style="width: 1rem;"></rmx-icon>
            <span>{{ calcApprovalRating(content.stats.likes, content.stats.dislikes) }}%</span>
        </div>
    </div>
    <div class="flex items-center flex-wrap mb-2">
        <dragonfish-tag-badge [kind]="tagKind.Type" [type]="content.kind" [size]="'medium'"></dragonfish-tag-badge>
        <dragonfish-tag-badge [kind]="tagKind.Category" [category]="content.meta.category" [size]="'medium'"></dragonfish-tag-badge>
        <ng-container *ngFor="let genre of content.meta.genres">
            <dragonfish-tag-badge [kind]="tagKind.Genre" [genre]="genre" [size]="'medium'"></dragonfish-tag-badge>
        </ng-container>
    </div>
    <ng-container *ngIf="content.tags !== null && content.tags.length > 0">
        <div class="card-tags flex flex-row items-center">
            <ng-container *ngIf="content.tags.length === 1; else multipleTags">
                    <span class="tag tags">
                        <a
                            [routerLink]="['/tag', content.tags[0]._id, content.tags[0].name | slugify]"
                            [innerHtml]="content.tags[0] | displayTags | safeHtml"
                        ></a>
                    </span>
            </ng-container>
            <ng-template #multipleTags>
                <ng-container *ngIf="showAllTags; else showOneTag">
                        <span class="tag tags">
                            <ng-container *ngFor="let tag of content.tags; let i = index">
                                <a
                                    [routerLink]="['/tag', tag._id, tag.name | slugify]"
                                    [innerHtml]="tag | displayTags | safeHtml"
                                ></a>
                                <ng-container *ngIf="i < content.tags.length - 1">
                                    ,
                                </ng-container>
                            </ng-container>
                        </span>
                    <rmx-icon name="arrow-up-s-line" (click)="toggleShowAllTags()"></rmx-icon>
                </ng-container>
                <ng-template #showOneTag>
                        <span class="tag tags">
                            <a
                                [routerLink]="['/tag', content.tags[0]._id, content.tags[0].name | slugify]"
                                [innerHtml]="content.tags[0] | displayTags | safeHtml"
                            ></a>
                        </span>
                    <rmx-icon name="arrow-down-s-line" (click)="toggleShowAllTags()"></rmx-icon>
                </ng-template>
            </ng-template>
        </div>
    </ng-container>
    <div class="work-body">
        <div class="cover" *ngIf="$any(content.meta).coverArt">
            <img [src]="$any(content.meta).coverArt" [alt]="'cover'">
        </div>
        <div class="desc">
            {{ content.desc }}
        </div>
    </div>
    <div class="work-meta bg-gray-200 dark:bg-gray-600">
        <div class="flex items-center" [matTooltip]="'Views'" [matTooltipClass]="'offprint-tooltip'" [matTooltipShowDelay]="300">
            <rmx-icon name="rhythm-fill" class="relative top-1 mr-0.5" style="width: 1rem;"></rmx-icon>
            <span>{{ content.stats.views | abbreviate }}</span>
        </div>
        <div class="text-sm mx-0.5 relative -top-0.5">
            •
        </div>
        <div class="flex items-center" [matTooltip]="'Words'" [matTooltipClass]="'offprint-tooltip'" [matTooltipShowDelay]="300">
            <rmx-icon name="pen-nib-line" class="relative top-1 mr-0.5" style="width: 1rem;"></rmx-icon>
            <span>{{ content.stats.words | abbreviate }}</span>
        </div>
        <div class="text-sm mx-0.5 relative -top-0.5">
            •
        </div>
        <div class="flex items-center" [matTooltip]="'Comments'" [matTooltipClass]="'offprint-tooltip'" [matTooltipShowDelay]="300">
            <rmx-icon name="discuss-line" class="relative top-1 mr-0.5" style="width: 1rem;"></rmx-icon>
            <span>{{ content.stats.comments | abbreviate }}</span>
        </div>
        <div class="text-sm mx-0.5 relative -top-0.5">
            •
        </div>
        <ng-container *ngIf="content.audit.publishedOn; else creationDate">
            <div class="flex items-center" [matTooltip]="'Published on'" [matTooltipClass]="'offprint-tooltip'" [matTooltipShowDelay]="300">
                <rmx-icon name="calendar-2-line" class="relative top-1 mr-0.5" style="width: 1rem;"></rmx-icon>
                <span>{{ content.audit.publishedOn | localedate: 'shortDate' }}</span>
            </div>
        </ng-container>
        <ng-template #creationDate>
            <div class="flex items-center" [matTooltip]="'Created on'" [matTooltipClass]="'offprint-tooltip'" [matTooltipShowDelay]="300">
                <rmx-icon name="calendar-2-line" class="relative top-1 mr-0.5" style="width: 1rem;"></rmx-icon>
                <span>{{ content.createdAt | localedate: 'shortDate' }}</span>
            </div>
        </ng-template>
        <div class="flex-1"></div>
        <div>
            {{ content.meta.status }}
        </div>
    </div>
</a>

<a
    class="small-card border border-gray-600 dark:border-white rounded-md"
    *ngIf="size === 'small'"
    [routerLink]="createContentUrl(content.kind, content._id, content.title)"
    [ngClass]="{'active': isActive}"
>
    <div class="flex">
        <h4
            class="block align-top text-lg font-medium overflow-ellipsis overflow-hidden whitespace-nowrap flex-1 self-center"
            style="line-height: 1.15rem;"
            [matTooltip]="content.title"
            [matTooltipClass]="'offprint-tooltip'"
            [matTooltipShowDelay]="300"
        >
            {{ content.title }}
        </h4>
        <dragonfish-tag-badge [kind]="tagKind.Rating" [rating]="content.meta.rating" [size]="'small'" [hasIcon]="false"></dragonfish-tag-badge>
    </div>
    <div class="work-body">
        <div class="cover" *ngIf="$any(content.meta).coverArt">
            <img [src]="$any(content.meta).coverArt" [alt]="'cover'">
        </div>
        <div class="desc">
            <div class="flex items-center flex-wrap">
                <dragonfish-tag-badge [kind]="tagKind.Type" [type]="content.kind" [size]="size"></dragonfish-tag-badge>
                <dragonfish-tag-badge [kind]="tagKind.Category" [category]="content.meta.category" [size]="size"></dragonfish-tag-badge>
                <ng-container *ngFor="let genre of content.meta.genres">
                    <dragonfish-tag-badge [kind]="tagKind.Genre" [genre]="genre" [size]="size"></dragonfish-tag-badge>
                </ng-container>
            </div>
            {{ content.desc }}
        </div>
    </div>
    <div class="work-meta bg-gray-200 dark:bg-gray-600">
        <div>
            by {{ $any(content.author).screenName }}
        </div>
        <div class="text-sm mx-0.5 relative -top-0.5">
            •
        </div>
        <div>
            {{ content.stats.words | abbreviate }} word{{ content.stats.words | pluralize }}
        </div>
        <div class="flex-1"></div>
        <div class="flex items-center">
            <rmx-icon name="heart-line" class="relative top-1" style="width: 1rem;"></rmx-icon>
            <span>{{ calcApprovalRating(content.stats.likes, content.stats.dislikes) }}%</span>
        </div>
    </div>
</a>

<div class="topbar z-50 top-0" [ngClass]="{ 'transparent': transparent, 'transition': !transparent, 'duration-500': !transparent, 'ease-in-out': !transparent }">
    <div class="flex items-center w-full h-full">
        <ng-content></ng-content>
        <div class="flex-1"><!--spacer--></div>
        <ng-container *ngIf="sessionQuery.currAccount$ | async as currAccount; else login">
            <ng-container *ngIf="pseudQuery.current$ | async as currentUser; else selectPseud">
                <div
                    class="flex flex-shrink-0 items-center h-full pr-2.5 pl-1.5"
                    [ngClass]="transparent ? 'border-l-0' : 'border-l'"
                    style="border-color: var(--accent-light);"
                >
                    <a
                        class="link-with-avatar cursor-pointer"
                        [ngClass]="{ 'active': activeUserMenu }"
                        (click)="openUserMenu()"
                        (mouseenter)="toggleUserTag()"
                        (mouseleave)="toggleUserTag()"
                    >
                        <img class="avatar" [src]="currentUser.profile.avatar" [alt]="'Avatar'" />
                        <div class="info ml-1 text-xs" [ngClass]="transparent ? 'hover:text-white' : 'text-white'">
                            <div class="font-bold truncate">{{ currentUser.screenName }}</div>
                            <ng-container *ngIf="tagShown; else taglineShown">
                                <div class="truncate">@{{ currentUser.userTag }}</div>
                            </ng-container>
                            <ng-template #taglineShown>
                                <div class="truncate">{{ currentUser.profile.tagline }}</div>
                            </ng-template>
                        </div>
                    </a>
                    <a
                        class="link cursor-pointer"
                        [matTooltip]="'Inbox'"
                        [matTooltipClass]="'offprint-tooltip'"
                        [ngClass]="{ 'active': activeInbox }"
                        (click)="openInbox()"
                    >
                        <span class="link-icon"><rmx-icon name="inbox-line"></rmx-icon></span>
                    </a>
                    <a
                        class="link"
                        [matTooltip]="'Settings'"
                        [matTooltipClass]="'offprint-tooltip'"
                        [routerLink]="['/settings']"
                    >
                        <span class="link-icon"><rmx-icon name="settings-5-line"></rmx-icon></span>
                    </a>
                </div>
            </ng-container>
            <ng-template #selectPseud>
                <div
                    class="flex flex-shrink-0 items-center h-full pr-2.5 pl-1.5"
                    [ngClass]="transparent ? 'border-l-0' : 'border-l'"
                    style="border-color: var(--accent-light);"
                >
                    <a
                        class="link flex items-center text-sm cursor-pointer"
                        [routerLink]="['/registration/select-pseud']"
                    >
                        <span class="link-icon mr-1"><rmx-icon name="user-line"></rmx-icon></span>
                        <span>Select Profile</span>
                    </a>
                    <a
                        class="link"
                        [matTooltip]="'Settings'"
                        [matTooltipClass]="'offprint-tooltip'"
                        [routerLink]="['/settings']"
                    >
                        <span class="link-icon"><rmx-icon name="settings-5-line"></rmx-icon></span>
                    </a>
                </div>
            </ng-template>
        </ng-container>
        <ng-template #login>
            <div
                class="flex flex-shrink-0 items-center h-full pr-2.5 pl-1.5"
                [ngClass]="transparent ? 'border-l-0' : 'border-l'"
                style="border-color: var(--accent-light);"
            >
                <a
                    class="link flex items-center text-sm cursor-pointer"
                    [routerLink]="['/registration']"
                >
                    <span class="link-icon mr-1"><rmx-icon name="login-circle-line"></rmx-icon></span>
                    <span>Log In</span>
                </a>
                <a
                    class="link"
                    [matTooltip]="'Settings'"
                    [matTooltipClass]="'offprint-tooltip'"
                    [routerLink]="['/settings']"
                >
                    <span class="link-icon"><rmx-icon name="settings-5-line"></rmx-icon></span>
                </a>
            </div>
        </ng-template>
    </div>
</div>

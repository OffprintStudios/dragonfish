<ng-container *ngIf="pseudQuery.current$ | async as user">
    <div class="absolute top-2 z-50 rounded-md" style="box-shadow: var(--dropshadow); left: 4.5rem;">
        <div class="menu-box">
            <div
                class="cover-pic absolute blur z-10 w-full h-20 rounded-t-md left-0 pointer-events-none overflow-hidden"
                [ngClass]="user.profile.coverPic ? '' : 'has-accent'"
            >
                <img
                    class="object-cover object-top object-center w-full h-full"
                    [src]="user.profile.coverPic"
                    *ngIf="user.profile.coverPic"
                />
            </div>
            <div class="user-header p-1.5 relative z-20 mt-8">
                <div class="flex flex-row items-center">
                    <div class="user-avatar">
                        <img [src]="user.profile.avatar" />
                    </div>
                    <div class="ml-2">
                        <div class="flex items-center">
                            <dragonfish-role-badge [roles]="user.roles" [size]="'small'"></dragonfish-role-badge>
                            <h2 class="text-xl font-medium relative top-0.5">
                                {{ user.screenName }}
                            </h2>
                        </div>
                        <h3 class="text-xs font-medium">
                            {{ user.profile.tagline }}
                        </h3>
                    </div>
                </div>
            </div>
            <div class="stats flex flex-row items-center justify-center">
                <div
                    class="flex flex-row items-center select-none cursor-default"
                    [matTooltip]="'Works'"
                    [matTooltipClass]="'offprint-tooltip'"
                    [matTooltipShowDelay]="600"
                >
                    <rmx-icon name="quill-pen-line"></rmx-icon>
                    <span class="select-none">{{ user.stats.works | abbreviate }}</span>
                </div>
                <div class="mx-1 select-none cursor-default">|</div>
                <div
                    class="flex flex-row items-center select-none cursor-default"
                    [matTooltip]="'Blogs'"
                    [matTooltipClass]="'offprint-tooltip'"
                    [matTooltipShowDelay]="600"
                >
                    <rmx-icon name="cup-line"></rmx-icon>
                    <span class="select-none">{{ user.stats.blogs | abbreviate }}</span>
                </div>
                <div class="mx-1 select-none cursor-default">|</div>
                <div
                    class="flex flex-row items-center select-none cursor-default"
                    [matTooltip]="'Followers'"
                    [matTooltipClass]="'offprint-tooltip'"
                    [matTooltipShowDelay]="600"
                >
                    <rmx-icon name="eye-line"></rmx-icon>
                    <span class="select-none">{{ user.stats.followers | abbreviate }}</span>
                </div>
            </div>
            <div class="my-2 border-b border-gray-600 dark:border-white w-11/12 mx-auto"><!--spacer--></div>
            <h4 class="font-medium uppercase mx-4 text-sm">Profile</h4>
            <div>
                <a
                    class="button w-full"
                    [routerLink]="['/profile', user._id, user.userTag]"
                >
                    <rmx-icon name="user-line"></rmx-icon>
                    View Profile
                </a>
                <a class="button w-full">
                    <rmx-icon name="group-line"></rmx-icon>
                    Friends
                </a>
                <a class="button w-full">
                    <rmx-icon name="chat-smile-3-line"></rmx-icon>
                    Messages
                </a>
                <a class="button w-full">
                    <rmx-icon name="notification-3-line"></rmx-icon>
                    Notifications
                </a>
            </div>
            <h4 class="font-medium uppercase mx-4 text-sm mt-2 mb-1">Account</h4>
            <div>
                <a class="button w-full" [routerLink]="['/registration/select-pseud']">
                    <rmx-icon name="group-2-line"></rmx-icon>
                    Switch Profile
                </a>
                <a
                    class="button w-full"
                    [routerLink]="['/reading-history']"
                >
                    <rmx-icon name="history-line"></rmx-icon>
                    Reading History
                </a>
                <ng-container *ngIf="sessionQuery.currAccount$ | async as account">
                    <ng-container *ngIf="canSeeDash(account.roles)">
                        <a
                            class="button w-full"
                            [routerLink]="['/dashboard/overview']"
                        >
                            <rmx-icon name="dashboard-line"></rmx-icon>
                            Dashboard
                        </a>
                        <div class="badge border-b w-9/12 mx-auto"><!--spacer--></div>
                    </ng-container>
                </ng-container>
                <a class="button bottom w-full cursor-pointer" (click)="logout()">
                    <rmx-icon name="logout-circle-line"></rmx-icon>
                    Log Out
                </a>
            </div>
        </div>
    </div>
</ng-container>

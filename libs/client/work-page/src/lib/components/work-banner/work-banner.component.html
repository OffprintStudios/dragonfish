<div class="header">
    <div class="flex w-11/12 md:w-9/12 lg:7/12 mx-auto px-4 py-6">
        <ng-container *ngIf="content.meta.coverArt; else uploadArt">
            <div
                class="edit-cover-art rounded-md"
                [matTooltip]="'Edit Cover Art'"
                [matTooltipClass]="'offprint-tooltip'"
                (mouseenter)="addEditIcon = true"
                (mouseleave)="addEditIcon = false"
                (click)="uploadCoverArt(content._id, content.kind)"
            >
                <span class="edit-icon" *ngIf="addEditIcon"><rmx-icon name="image-edit-line"></rmx-icon></span>
                <img class="rounded-md" [src]="content.meta.coverArt" />
            </div>
        </ng-container>
        <ng-template #uploadArt>
            <div
                class="add-cover-art h-72 w-48 rounded-md cursor-pointer flex flex-col items-center justify-center"
                [matTooltip]="'Add Cover Art'"
                [matTooltipClass]="'offprint-tooltip'"
                (click)="uploadCoverArt(content._id, content.kind)"
                *ngIf="auth.checkPseudonym(content.author._id)"
            >
                <rmx-icon name="add-box-line"></rmx-icon>
            </div>
        </ng-template>
        <div class="flex-1 flex flex-col justify-end">
            <div class="flex items-center">
                <div class="flex-1">
                    <h1 class="text-white text-4xl font-medium">{{ content.title }}</h1>
                    <h2 class="text-white text-xl italic hover:underline cursor-pointer" [routerLink]="['/profile', content.author._id, content.author.userTag]">
                        by {{ content.author.screenName }}
                    </h2>
                </div>
                <button class="header-button" (click)="addToLibrary()">
                    <rmx-icon name="add-box-line"></rmx-icon>
                    <span>Library</span>
                </button>
                <div class="mx-1"></div>
                <button
                    class="header-button"
                    [matMenuTriggerFor]="moreMenu"
                    [ngClass]="{'active': moreMenuOpened}"
                    (menuOpened)="toggleMoreMenu()"
                    (menuClosed)="toggleMoreMenu()"
                >
                    <rmx-icon name="more-2-fill" class="mr-0"></rmx-icon>
                </button>
            </div>
            <div class="flex items-center w-full">
                <dragonfish-tag-badge [kind]="tagKind.Type">
                    <ng-container *ngIf="content.kind === 'ProseContent'">
                        <rmx-icon name="book-open-line"></rmx-icon>
                        <span>Prose</span>
                    </ng-container>
                    <ng-container *ngIf="content.kind === 'PoetryContent'">
                        <rmx-icon name="quill-pen-line"></rmx-icon>
                        <span>Poetry</span>
                    </ng-container>
                </dragonfish-tag-badge>
                <dragonfish-tag-badge [kind]="tagKind.Category">
                    <ng-container *ngIf="content.meta.category === 'Original'">
                        <rmx-icon name="loader-2-line"></rmx-icon>
                        <span>{{ content.meta.category }}</span>
                    </ng-container>
                </dragonfish-tag-badge>
                <ng-container *ngFor="let genre of content.meta.genres">
                    <dragonfish-tag-badge [kind]="tagKind.Genre" [genre]="genre"></dragonfish-tag-badge>
                </ng-container>
            </div>
            <div class="flex items-center w-full mt-6 border-b-2 border-white">
                <div
                    class="nav-link px-10"
                    [routerLink]="contentUrl"
                    [routerLinkActive]="'active'"
                    [routerLinkActiveOptions]="{ exact: true }"
                >
                    <rmx-icon name="information-line"></rmx-icon>
                    <span>Info</span>
                </div>
                <div class="nav-link px-7" [routerLink]="['comments']" [routerLinkActive]="'active'">
                    <rmx-icon name="discuss-line"></rmx-icon>
                    <span>{{ content.stats.comments | abbreviate }} Comment{{ content.stats.comments | pluralize }}</span>
                </div>
                <div class="nav-link px-6" [routerLink]="['related']" [routerLinkActive]="'active'">
                    <rmx-icon name="collage-line"></rmx-icon>
                    <span>Related Stuff</span>
                </div>
            </div>
        </div>
        <!--<div class="flex">
            <ng-container *ngIf="content.meta.coverArt; else uploadArt">
                <div
                    class="edit-cover-art rounded-md"
                    [matTooltip]="'Edit Cover Art'"
                    [matTooltipClass]="'offprint-tooltip'"
                    (mouseenter)="addEditIcon = true"
                    (mouseleave)="addEditIcon = false"
                    (click)="uploadCoverArt(content._id, content.kind)"
                >
                    <span class="edit-icon" *ngIf="addEditIcon"><rmx-icon name="image-edit-line"></rmx-icon></span>
                    <img class="rounded-md" [src]="content.meta.coverArt" />
                </div>
            </ng-container>
            <ng-template #uploadArt>
                <div
                    class="add-cover-art h-72 w-48 rounded-md cursor-pointer flex flex-row items-center justify-center"
                    [matTooltip]="'Add Cover Art'"
                    [matTooltipClass]="'offprint-tooltip'"
                    (click)="uploadCoverArt(content._id, content.kind)"
                >
                    <rmx-icon name="add-box-line"></rmx-icon>
                </div>
            </ng-template>
            <div class="rounded-md py-2 px-8 flex-1" style="color: var(--text-color); background: var(--background); box-shadow: var(--dropshadow);">
                <div class="html-description" [innerHtml]="content.body | safeHtml"></div>
            </div>
        </div>-->
    </div>
</div>

<mat-menu #moreMenu='matMenu' xPosition="before">
    <button mat-menu-item class="hover:scale-100" (click)="shareContent()">
        <rmx-icon name="share-box-line"></rmx-icon>
        <span>Share this</span>
    </button>
    <div class="w-full border-b border-gray-600 dark:border-white my-1"></div>
    <button mat-menu-item class="hover:scale-100" (click)="reportContent()">
        <rmx-icon name="alert-line"></rmx-icon>
        <span>Send report</span>
    </button>
</mat-menu>

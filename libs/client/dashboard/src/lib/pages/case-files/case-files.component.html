<ng-container *ngIf="caseQuery.loading$ | async else notLoading">
    <div class="flex flex-row items-center justify-center h-72">
        <mat-spinner></mat-spinner>
    </div>
</ng-container>

<ng-template #notLoading>
    <ng-container *ngIf="caseQuery.all$ | async as caseFiles">
        <ng-container *ngIf="caseFiles.length === 0; else notEmpty">
            <div class="empty">
                <h3>Looks like there something missing here...</h3>
                <p>If you think this is an error, contact your system administrator.</p>
            </div>
        </ng-container>
        <ng-template #notEmpty>
            <div class="w-8/12 mx-auto my-8">
                <mat-accordion>
                    <ng-container *ngFor="let caseFile of caseFiles">
                        <mat-expansion-panel>
                            <mat-expansion-panel-header>
                                <mat-panel-title>
                                    Case #{{ caseFile._id }}
                                </mat-panel-title>
                                <mat-panel-description>
                                    <ng-container [ngSwitch]="caseFile.kind">
                                        <ng-container *ngSwitchCase="caseKind.Users">
                                            Regarding User <strong class="ml-1">{{ $any(caseFile).user.username }}</strong>
                                        </ng-container>
                                        <ng-container *ngSwitchCase="caseKind.Content">
                                            Regarding <strong class="ml-1">"{{ $any(caseFile).content.title }}"</strong>
                                        </ng-container>
                                    </ng-container>
                                </mat-panel-description>
                            </mat-expansion-panel-header>
                            <div class="flex w-full h-full">
                                <div class="border rounded-md shadow-lg p-4 w-1/2 mr-2" style="border-color: var(--borders)">
                                    <h2 class="text-3xl font-medium">Stats</h2>
                                    <div class="text-2xl"><strong>{{ caseFile.reports.length | abbreviate }}</strong> report{{ caseFile.reports.length | pluralize }}</div>
                                    <div class="text-2xl"><strong>{{ caseFile.notes.length | abbreviate }}</strong> note{{ caseFile.notes.length | pluralize }}</div>
                                </div>
                                <div class="flex flex-col w-1/2">
                                    <div class="border rounded-md shadow-lg p-4 mb-2" style="border-color: var(--borders)">
                                        <h2 class="text-3xl font-medium">Filed on</h2>
                                        <span class="text-2xl">{{ caseFile.createdAt | localedate: 'mediumDate' }}</span>
                                    </div>
                                    <div class="border rounded-md shadow-lg p-4" style="border-color: var(--borders)">
                                        <ng-container *ngIf="caseFile.claimedBy; else notClaimed">
                                            <h2 class="text-3xl font-medium">Claimed By</h2>
                                            <div>
                                                <span><img [src]="caseFile.claimedBy.profile.avatar" class="w-16 rounded-md"></span>
                                                <span class="text-2xl">{{ actionType[caseFile.action.hasType] }}</span>
                                            </div>
                                        </ng-container>
                                        <ng-template #notClaimed>
                                            <h2 class="text-3xl font-medium">Not Yet Claimed</h2>
                                        </ng-template>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-2.5 border-t pt-1 text-center" style="border-color: var(--borders)">
                                <a (click)="viewCase(caseFile._id)">View File >></a>
                            </div>
                        </mat-expansion-panel>
                    </ng-container>
                </mat-accordion>
            </div>
        </ng-template>
    </ng-container>
</ng-template>

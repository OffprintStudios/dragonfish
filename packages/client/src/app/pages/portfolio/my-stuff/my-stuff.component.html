<div class="tools">
    <ng-container *ngIf="route.children.length === 0; else goBack">
        <div class="tool-buttons">
            <!--Creation tools-->
            <button matRipple class="tool left" [matMenuTriggerFor]="createMenu"><i-feather name="loader"></i-feather>Create</button>
            <button matRipple class="tool end" matTooltip="Create Folder" matTooltipClass="offprint-tooltip" (click)="openNewFormDialog()">
                <i-feather class="no-text" name="folder-plus"></i-feather>
            </button>
            <span class="tool-divider"></span>

            <!--Filtering tools-->
            <button matRipple class="tool left" matTooltip="List View" matTooltipClass="offprint-tooltip">
                <i-feather class="no-text" name="list"></i-feather>
            </button>
            <button matRipple class="tool mid" matTooltip="Icon View" matTooltipClass="offprint-tooltip">
                <i-feather class="no-text" name="grid"></i-feather>
            </button>
            <button matRipple class="tool end" matTooltip="Filter" matTooltipClass="offprint-tooltip" [matMenuTriggerFor]="filterMenu">
                <i-feather class="no-text" name="filter"></i-feather>
            </button>
            <span class="tool-divider"></span>

            <!--Content tools-->
            <ng-container *ngIf="itemSelected; else noItem">
                <button matRipple class="tool left" (click)="deselect()" matTooltip="Deselect" matTooltipClass="offprint-tooltip">
                    <i-feather class="no-text" name="x"></i-feather>
                </button>
                <button matRipple class="tool mid" (click)="viewContent(currSelectedContent)" matTooltip="Edit" matTooltipClass="offprint-tooltip">
                    <i-feather class="no-text" name="edit-3"></i-feather>
                </button>
                <button matRipple class="tool end" (click)="deleteContent(currSelectedContent)" matTooltip="Delete" matTooltipClass="offprint-tooltip">
                    <i-feather class="no-text" name="trash-2"></i-feather>
                </button>
                <span class="tool-divider"></span>
                <ng-container [ngSwitch]="currSelectedContent.audit.published">
                    <button *ngSwitchCase="pubStatus.Published" matRipple class="tool active">
                        <i-feather name="book-open"></i-feather>Published
                    </button>
                    <button *ngSwitchCase="pubStatus.Unpublished" matRipple class="tool" (click)="publishContent(currSelectedContent)">
                        <i-feather name="book"></i-feather>Unpublished
                    </button>
                    <button *ngSwitchCase="pubStatus.Pending" matRipple class="tool">
                        <i-feather name="clock"></i-feather>Pending
                    </button>
                    <button *ngSwitchCase="pubStatus.Rejected" matRipple class="tool">
                        <i-feather name="x"></i-feather>Rejected
                    </button>
                    <button *ngSwitchCase="pubStatus.ApprovedUnpublished" matRipple class="tool">
                        <i-feather name="book"></i-feather>Approved
                    </button>
                </ng-container>
            </ng-container>
            <ng-template #noItem>
                <button matRipple class="tool left disabled" matTooltip="Deselect" matTooltipClass="offprint-tooltip">
                    <i-feather class="no-text" name="x"></i-feather>
                </button>
                <button matRipple class="tool mid disabled" matTooltip="Edit" matTooltipClass="offprint-tooltip">
                    <i-feather class="no-text" name="edit-3"></i-feather>
                </button>
                <button matRipple class="tool end disabled" matTooltip="Delete" matTooltipClass="offprint-tooltip">
                    <i-feather class="no-text" name="trash-2"></i-feather>
                </button>
                <span class="tool-divider"></span>
                <button matRipple class="tool disabled">
                    <i-feather name="book"></i-feather>Unpublished
                </button>
            </ng-template>
        </div>
        <form [formGroup]="searchStuff" class="tool-search">
            <div class="search-bar">
                <input type="text" formControlName="query" class="search-input" placeholder="Search your stuff...">
                <button matRipple class="search-submit" type="submit"><i-feather name="search"></i-feather></button>
            </div>
        </form>
    </ng-container>
    <ng-template #goBack>
        <div class="tool-buttons">
            <!--Creation tools-->
            <button matRipple class="tool left" [routerLink]="['/portfolio', currentUser._id, currentUser.username | slugify, 'my-stuff']"><i-feather name="chevron-left"></i-feather>Back</button>
            <button matRipple class="tool end disabled" matTooltip="Create Folder" matTooltipClass="offprint-tooltip">
                <i-feather class="no-text" name="folder-plus"></i-feather>
            </button>
            <span class="tool-divider"></span>
    
            <!--Filtering tools-->
            <button matRipple class="tool left disabled" matTooltip="List View" matTooltipClass="offprint-tooltip">
                <i-feather class="no-text" name="list"></i-feather>
            </button>
            <button matRipple class="tool mid disabled" matTooltip="Icon View" matTooltipClass="offprint-tooltip">
                <i-feather class="no-text" name="grid"></i-feather>
            </button>
            <button matRipple class="tool end disabled" matTooltip="Filter" matTooltipClass="offprint-tooltip">
                <i-feather class="no-text" name="filter"></i-feather>
            </button>
            <span class="tool-divider"></span>
    
            <!--Content-specific tools-->
            <button matRipple class="tool left disabled" matTooltip="Deselect" matTooltipClass="offprint-tooltip">
                <i-feather class="no-text" name="x"></i-feather>
            </button>
            <button matRipple class="tool mid disabled" matTooltip="Publish" matTooltipClass="offprint-tooltip">
                <i-feather class="no-text" name="book"></i-feather>
            </button>
            <button matRipple class="tool mid disabled" matTooltip="Edit" matTooltipClass="offprint-tooltip">
                <i-feather class="no-text" name="edit-3"></i-feather>
            </button>
            <button matRipple class="tool end disabled" matTooltip="Delete" matTooltipClass="offprint-tooltip">
                <i-feather class="no-text" name="trash-2"></i-feather>
            </button>
            <span class="tool-divider"></span>
            <button matRipple class="tool disabled">
                <i-feather name="book"></i-feather>Unpublished
            </button>
        </div>
        <form [formGroup]="searchStuff" class="tool-search">
            <div class="search-bar">
                <input type="text" formControlName="query" class="search-input disabled" placeholder="Search your stuff..." disabled>
                <button matRipple class="search-submit disabled" type="submit"><i-feather name="search"></i-feather></button>
            </div>
        </form>
    </ng-template>
</div>

<mat-menu #createMenu="matMenu">
    <button mat-menu-item [routerLink]="['new-work']"><i-feather name="book"></i-feather>Add Work</button>
    <button mat-menu-item [routerLink]="['new-blog']"><i-feather name="coffee"></i-feather>Add Blog</button>
</mat-menu>

<mat-menu #filterMenu="matMenu">
    <button mat-menu-item>By Name</button>
    <button mat-menu-item>By Kind</button>
    <button mat-menu-item>By Date Added</button>
</mat-menu>

<ng-container *ngIf="route.children.length === 0; else openedForms">
    <ng-container *ngIf="myContent.length === 0 && myFolders.length === 0; else hasContent">
        <div class="empty">
            <h3>It's pretty lonely here...</h3>
            <p>Why not add some content by hitting the create button?</p>
        </div>
    </ng-container>
    
    <ng-template #hasContent>
        <div class="content-folders">
            <ng-container *ngFor="let folder of myFolders">
                <div class="folder-box">
                    <i-feather name="folder"></i-feather>
                    <h5>{{ folder.name }}</h5>
                </div>
            </ng-container>
        </div>
        <div class="content-grid">
            <ng-container *ngFor="let content of myContent">
                <div class="content-box" (click)="selectItem(content)" (dblclick)="viewContent(content)" [ngClass]="{'selected': content.audit.selected}">
                    <div class="content-description">
                        <ng-container [ngSwitch]="content.kind">
                            <i-feather *ngSwitchCase="contentKind.BlogContent" name="coffee" [matTooltip]="'Blog'" [matTooltipClass]="'offprint-tooltip'"></i-feather>
                            <i-feather *ngSwitchCase="contentKind.WorkContent" name="feather" [matTooltip]="'Work'" [matTooltipClass]="'offprint-tooltip'"></i-feather>
                        </ng-container>
                        <h5>{{ content.title }}</h5>
                    </div>
                    <div class="content-preview">
                        <div class="html-description" [innerHtml]="content.body | safeHtml"></div>
                    </div>
                    <div class="content-stats">
                        <span class="stat-block" [matTooltip]="'Views'" [matTooltipClass]="'offprint-tooltip'">
                            <i-feather class="stat-icon" name="eye"></i-feather>{{ content.stats.views | abbreviate}}
                        </span>
                        <span class="stat-divider"></span>
                        <span class="stat-block" [matTooltip]="'Comments'" [matTooltipClass]="'offprint-tooltip'">
                            <i-feather class="stat-icon" name="message-circle"></i-feather>{{ content.stats.comments | abbreviate }}
                        </span>
                        <span class="stat-divider"></span>
                        <span class="stat-block" [matTooltip]="'Likes'" [matTooltipClass]="'offprint-tooltip'">
                            <i-feather class="stat-icon" name="thumbs-up"></i-feather>{{ content.stats.likes | abbreviate }}
                        </span>
                        <span class="stat-divider"></span>
                        <span class="stat-block" [matTooltip]="'Dislikes'" [matTooltipClass]="'offprint-tooltip'">
                            <i-feather class="stat-icon" name="thumbs-down"></i-feather>{{ content.stats.dislikes | abbreviate }}
                        </span>
                        <span class="stat-divider"></span>
                        <ng-container [ngSwitch]="content.audit.published">
                            <span *ngSwitchCase="pubStatus.Published" class="stat-block" [matTooltip]="'Published'" [matTooltipClass]="'offprint-tooltip'">
                                <i-feather class="stat-icon" name="book-open"></i-feather>
                            </span>
                            <span *ngSwitchCase="pubStatus.Unpublished" class="stat-block" [matTooltip]="'Unpublished'" [matTooltipClass]="'offprint-tooltip'">
                                <i-feather class="stat-icon" name="book"></i-feather>
                            </span>
                            <span *ngSwitchCase="pubStatus.Pending" class="stat-block" [matTooltip]="'Pending'" [matTooltipClass]="'offprint-tooltip'">
                                <i-feather class="stat-icon" name="clock"></i-feather>
                            </span>
                            <span *ngSwitchCase="pubStatus.Rejected" class="stat-block" [matTooltip]="'Rejected'" [matTooltipClass]="'offprint-tooltip'">
                                <i-feather class="stat-icon" name="x"></i-feather>
                            </span>
                            <span *ngSwitchCase="pubStatus.ApprovedUnpublished" class="stat-block" [matTooltip]="'Approved (Unpublished)'" [matTooltipClass]="'offprint-tooltip'">
                                <i-feather class="stat-icon" name="book"></i-feather>
                            </span>
                        </ng-container>
                    </div>
                </div>
            </ng-container>
        </div>
    </ng-template>
</ng-container>

<ng-template #openedForms>
    <router-outlet></router-outlet>
</ng-template>
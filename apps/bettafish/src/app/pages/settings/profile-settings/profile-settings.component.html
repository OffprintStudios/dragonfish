<div class="p-3.5 flex flex-col mt-6 mx-auto w-11/12">
    <div class="flex items-center">
        <h1 class="text-3xl font-medium flex-1">Select Profile</h1>
        <ng-container *ngIf="pseudQuery.numPseuds !== 3; else equalsThree">
            <span class="italic mr-4">{{ pseudQuery.numPseuds }} out of 3</span>
            <button><rmx-icon name="add-box-line"></rmx-icon>Add Profile</button>
        </ng-container>
        <ng-template #equalsThree>
            <span class="italic">{{ pseudQuery.numPseuds }} out of 3</span>
        </ng-template>
    </div>
    <div class="flex items-center justify-center overflow-x-auto border-b border-gray-700 dark:border-white">
        <ng-container *ngIf="pseudQuery.all$ | async as pseudonyms">
            <ng-container *ngIf="pseudonyms.length !== 0">
                <div
                    class="user-card rounded-md w-64 relative"
                    *ngFor="let user of pseudonyms" (click)="selectPseud(user._id)"
                    [ngClass]="{ 'active': pseudQuery.currentId === user._id }">
                    <div
                        class="absolute z-20 top-0 right-0 rounded-tr-md rounded-bl-md text-white border-l border-b border-white"
                        *ngIf="pseudQuery.currentId === user._id"
                        style="background: var(--accent);"
                    >
                        <rmx-icon name="check-line"></rmx-icon>
                    </div>
                    <div
                        class="cover-pic absolute blur z-10 w-full h-20 top-0 left-0 rounded-md pointer-events-none overflow-hidden"
                        [ngClass]="user.profile.coverPic ? '' : 'has-accent'"
                    >
                        <img
                            class="object-cover object-top object-center w-full h-full"
                            [src]="user.profile.coverPic"
                            *ngIf="user.profile.coverPic"
                        />
                    </div>
                    <div class="user-header p-1.5 relative z-20 mt-8">
                        <div class="flex flex-row items-center">
                            <div class="user-avatar">
                                <img [src]="user.profile.avatar" />
                            </div>
                            <div class="ml-2">
                                <h2 class="text-xl font-medium">
                                    {{ user.screenName }}
                                </h2>
                                <h3 class="text-xs font-medium">
                                    @{{ user.userTag }}
                                </h3>
                            </div>
                        </div>
                    </div>
                    <div class="stats flex flex-row items-center justify-center">
                        <div
                            class="flex flex-row items-center select-none cursor-default"
                            [matTooltip]="'Works'"
                            [matTooltipClass]="'offprint-tooltip'"
                            [matTooltipShowDelay]="600"
                        >
                            <rmx-icon name="quill-pen-line"></rmx-icon>
                            <span class="select-none">{{ user.stats.works | abbreviate }}</span>
                        </div>
                        <div class="mx-1 select-none cursor-default">|</div>
                        <div
                            class="flex flex-row items-center select-none cursor-default"
                            [matTooltip]="'Blogs'"
                            [matTooltipClass]="'offprint-tooltip'"
                            [matTooltipShowDelay]="600"
                        >
                            <rmx-icon name="cup-line"></rmx-icon>
                            <span class="select-none">{{ user.stats.blogs | abbreviate }}</span>
                        </div>
                        <div class="mx-1 select-none cursor-default">|</div>
                        <div
                            class="flex flex-row items-center select-none cursor-default"
                            [matTooltip]="'Followers'"
                            [matTooltipClass]="'offprint-tooltip'"
                            [matTooltipShowDelay]="600"
                        >
                            <rmx-icon name="eye-line"></rmx-icon>
                            <span class="select-none">{{ user.stats.followers | abbreviate }}</span>
                        </div>
                    </div>
                    <div class="my-1"></div>
                </div>
            </ng-container>
        </ng-container>
    </div>
</div>
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mx-auto w-11/12">
    <ng-container *ngIf="pseudQuery.current$ | async as user">
        <div class="p-2 border border-gray-600 dark:border-white rounded-md shadow-xl">
            <h3 class="text-xl font-medium text-center">Avatar</h3>
            <div class="flex flex-col items-center justify-center">
                <img [alt]="'Avatar'" [src]="user.profile.avatar" class="avatar" />
                <button class="mt-2.5" (click)="changeAvatar()">
                    <rmx-icon name="image-edit-line"></rmx-icon>
                    Change Avatar
                </button>
            </div>
        </div>
        <div class="p-2 border border-gray-600 dark:border-white rounded-md shadow-xl">
            <h3 class="text-xl font-medium text-center">Display Name</h3>
            <form [formGroup]="changeScreenNameForm" class="flex flex-col items-center">
                <div class="flex-1">
                    <dragonfish-text-field
                        [formControlName]="'screenName'"
                        [name]="'screenName'"
                        [type]="'text'"
                        [label]="'Display Name'"
                        [placeholder]="'Beatriz Ex Machina'"
                    ></dragonfish-text-field>
                </div>
                <button type="submit"><rmx-icon name="save-3-line"></rmx-icon>Save</button>
            </form>
        </div>
        <div class="p-2 border border-gray-600 dark:border-white rounded-md shadow-xl">
            <h3 class="text-xl font-medium text-center">About Me</h3>
            <form [formGroup]="changeBioForm" class="flex flex-col items-center">
                <div class="flex-1">
                    <dragonfish-text-area
                        [formControlName]="'bio'"
                        [name]="'bio'"
                        [label]="'About Me'"
                        [placeholder]="'Just another face in the crowd'"
                    ></dragonfish-text-area>
                </div>
                <button type="submit"><rmx-icon name="save-3-line"></rmx-icon>Save</button>
            </form>
        </div>
        <div class="p-2 border border-gray-600 dark:border-white rounded-md shadow-xl" *ngIf="canSeeTaglineForm(user.roles)">
            <h3 class="text-xl font-medium text-center">Tagline</h3>
            <form [formGroup]="taglineForm" class="flex flex-col items-center">
                <div class="flex-1">
                    <dragonfish-text-field
                        [formControlName]="'tagline'"
                        [name]="'tagline'"
                        [type]="'text'"
                        [label]="'Tagline'"
                        [placeholder]="'Member'"
                    ></dragonfish-text-field>
                </div>
                <button type="submit"><rmx-icon name="save-3-line"></rmx-icon>Save</button>
            </form>
        </div>
    </ng-container>
</div>
